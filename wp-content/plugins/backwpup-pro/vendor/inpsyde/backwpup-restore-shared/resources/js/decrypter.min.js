window.BWU=window.BWU||{},function(e,c,s){function o(){this.containerEl.style.display="block"}function r(){this.keyField.value="",this.keyField.setAttribute("value","")}function i(t){"invalid"===t&&function(){s(this.keyField).not(":focus").focus()}.call(this)}var d={needDecryption:function(t){o.call(this),i.call(this,t)},hide:function(){this.containerEl.style.display="none"},destruct:function(){this.hide(),r.call(this)},decrypt:function(t){t=c.extend(t,{decryption_key:this.keyField.value,action:"decrypt",controller:"decrypt"});var i=function(t){if(!t.success)return o.call(this),e.Functions.printMessageError(t.data.message,this.containerEl),void s("body").trigger(this.ACTION_DECRYPTION_FAILED,t);this.hide(),r.call(this),s("body").trigger(this.ACTION_DECRYPTION_SUCCESS,t)}.bind(this),n=function(t){this.hide(),r.call(this),s("body").trigger(this.ACTION_DECRYPTION_FAILED,t)}.bind(this);this.hide(),s.ajax({url:this.url,data:t,method:"POST",success:i,error:n})},construct:function(t,i,n){return c.bindAll(this,"needDecryption","decrypt","destruct","hide"),!(!i||!n)&&(this.url=t,this.containerEl=i,this.keyField=n,this)}};e.DecrypterFactory=function(t,i,n){return Object.create(d,{ACTION_DECRYPTION_SUCCESS:e.Functions.makeConstant("backwpup.decryption_access"),ACTION_DECRYPTION_FAILED:e.Functions.makeConstant("backwpup.decryption_failed")}).construct(t,i,n)}}(window.BWU,window._,window.jQuery);